<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Custom Notepad with AI</title>
        <link href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Playwrite+IT+Moderna&family=Indie+Flower&display=swap" rel="stylesheet" />
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            body {
                padding: 20px;
                min-height: 100vh;
                background: repeating-linear-gradient(0deg, transparent, transparent 19px, rgba(0, 0, 0, 0.1) 20px);
                font-family: Arial, sans-serif;
                overflow: auto;
            }
            .heading {
                font-family: "Playwrite IT Moderna", cursive !important;
                font-size: 6em;
                color: rgba(255, 0, 0, 0.3);
                text-align: center;
                margin: 20px 0;
            }
            .box-container {
                display: flex;
                flex-wrap: wrap-reverse;
                gap: 20px;
                margin-bottom: 20px;
            }
            .box,
            .image-container {
                font-family: "Indie Flower", cursive !important;
                border: 22px solid rgba(128, 0, 128, 0.1);
                padding: 15px;
                min-height: 100px;
                border-radius: 5px;
                background: rgba(255, 255, 255, 0);
                width: 400px;
                box-sizing: border-box;
                position: relative;
                cursor: move;
                touch-action: none;
            }
            .side-heading {
                font-family: "Lilita One", cursive !important;
                font-size: 2.8em;
                color: rgba(0, 0, 255, 0.3);
                margin-bottom: 10px;
            }
            .body-text {
                font-family: "Indie Flower", cursive !important;
                font-size: 1.2em;
                color: black;
                line-height: 1.6;
                text-align: left;
            }
            .line {
                height: 18px;
                background: rgba(255, 192, 203, 0.4);
                margin: 30px auto;
                width: 50%;
                border-radius: 2px;
                clear: both;
            }
            #imageInput {
                display: none;
            }
            .image-container img {
                max-width: 100%;
                border-radius: 5px;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            }
            #content::after {
                content: "";
                display: table;
                clear: both;
            }
            [contenteditable] {
                outline: none;
            }
            .fonts-loaded {
                opacity: 1;
                transition: opacity 0.3s ease;
            }
            .toolbar {
                margin-bottom: 20px;
            }
            .toolbar button {
                padding: 10px;
                margin-right: 10px;
                cursor: pointer;
            }
            .popup {
                display: none;
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 20px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
                z-index: 1000;
            }
            .overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 999;
            }
        </style>
    </head>
    <body>
        <div class="toolbar">
            <button onclick="addElement('heading')">Heading</button>
            <button onclick="addElement('box')">Box</button>
            <button onclick="addElement('line')">Line</button>
            <input type="file" id="imageInput" accept="image/*" onchange="addImage(event)" />
            <button onclick="document.getElementById('imageInput').click()">Add Image</button>
            <button onclick="openPopup()">Generate AI Content</button>
        </div>
        <div id="content" contenteditable="true"></div>
        <div class="overlay" id="overlay"></div>
        <div class="popup" id="popup">
            <h2>Enter Topic</h2>
            <input type="text" id="topicInput" placeholder="Enter topic name" />
            <button onclick="generateContent()">Generate</button>
            <button onclick="closePopup()">Close</button>
        </div>

        <script>
            document.fonts.ready.then(() => {
                document.body.classList.add("fonts-loaded");
            });
            function addElement(type) {
                const content = document.getElementById("content");
                let element;
                switch (type) {
                    case "heading":
                        element = document.createElement("div");
                        element.className = "heading";
                        element.textContent = "Your Heading";
                        attachVerticalMoveListeners(element);
                        break;
                    case "box":
                        const boxContainer = document.createElement("div");
                        boxContainer.className = "box-container";
                        const box = document.createElement("div");
                        box.className = "box";
                        const sideHeading = document.createElement("div");
                        sideHeading.className = "side-heading";
                        sideHeading.textContent = "Side Heading";
                        const bodyText = document.createElement("div");
                        bodyText.className = "body-text";
                        bodyText.textContent = "Start typing your paragraph here...";
                        box.appendChild(sideHeading);
                        box.appendChild(bodyText);
                        boxContainer.appendChild(box);
                        element = boxContainer;
                        attachMoveAndResizeListeners(box);
                        break;
                    case "line":
                        element = document.createElement("div");
                        element.className = "line";
                        attachVerticalMoveListeners(element);
                        break;
                }
                content.appendChild(element);
                if (element.textContent) {
                    const range = document.createRange();
                    const sel = window.getSelection();
                    range.selectNodeContents(element);
                    sel.removeAllRanges();
                    sel.addRange(range);
                }
            }
            function addImage(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const img = document.createElement("img");
                        img.src = e.target.result;
                        const container = document.createElement("div");
                        container.className = "image-container";
                        container.appendChild(img);
                        document.getElementById("content").appendChild(container);
                        attachMoveAndResizeListeners(container);
                    };
                    reader.readAsDataURL(file);
                }
            }
            function attachMoveAndResizeListeners(element) {
                let isDragging = false;
                let offsetX, offsetY;
                element.addEventListener("mousedown", function (e) {
                    if (e.target === element || e.target.tagName === "IMG") {
                        isDragging = true;
                        offsetX = e.offsetX;
                        offsetY = e.offsetY;
                    }
                });
                document.addEventListener("mousemove", function (e) {
                    if (isDragging) {
                        element.style.position = "absolute";
                        element.style.left = e.pageX - offsetX + "px";
                        element.style.top = e.pageY - offsetY + "px";
                    }
                });
                document.addEventListener("mouseup", function () {
                    isDragging = false;
                });
                element.addEventListener("touchstart", function (e) {
                    if (e.target === element || e.target.tagName === "IMG") {
                        isDragging = true;
                        const touch = e.touches[0];
                        offsetX = touch.clientX - element.offsetLeft;
                        offsetY = touch.clientY - element.offsetTop;
                    }
                });
                document.addEventListener("touchmove", function (e) {
                    if (isDragging) {
                        const touch = e.touches[0];
                        element.style.position = "absolute";
                        element.style.left = touch.clientX - offsetX + "px";
                        element.style.top = touch.clientY - offsetY + "px";
                    }
                });
                document.addEventListener("touchend", function () {
                    isDragging = false;
                });
                element.addEventListener("mousedown", function (e) {
                    const rect = element.getBoundingClientRect();
                    const cornerSize = 10;
                    if (e.pageX > rect.right - cornerSize && e.pageY > rect.bottom - cornerSize) {
                        element.style.cursor = "se-resize";
                        document.addEventListener("mousemove", resize);
                        document.addEventListener("mouseup", () => {
                            document.removeEventListener("mousemove", resize);
                            element.style.cursor = "move";
                        });
                    }
                });
                element.addEventListener("touchstart", function (e) {
                    const rect = element.getBoundingClientRect();
                    const touch = e.touches[0];
                    const cornerSize = 10;
                    if (touch.clientX > rect.right - cornerSize && touch.clientY > rect.bottom - cornerSize) {
                        element.style.cursor = "se-resize";
                        document.addEventListener("touchmove", resizeTouch);
                        document.addEventListener("touchend", () => {
                            document.removeEventListener("touchmove", resizeTouch);
                            element.style.cursor = "move";
                        });
                    }
                });
                function resize(e) {
                    element.style.width = e.pageX - element.offsetLeft + "px";
                    element.style.height = e.pageY - element.offsetTop + "px";
                }
                function resizeTouch(e) {
                    const touch = e.touches[0];
                    element.style.width = touch.clientX - element.offsetLeft + "px";
                    element.style.height = touch.clientY - element.offsetTop + "px";
                }
            }
            function attachVerticalMoveListeners(element) {
                let isDragging = false;
                let offsetY;
                element.addEventListener("mousedown", function (e) {
                    isDragging = true;
                    offsetY = e.offsetY;
                });
                document.addEventListener("mousemove", function (e) {
                    if (isDragging) {
                        element.style.position = "absolute";
                        element.style.top = e.pageY - offsetY + "px";
                    }
                });
                document.addEventListener("mouseup", function () {
                    isDragging = false;
                });
                element.addEventListener("touchstart", function (e) {
                    isDragging = true;
                    const touch = e.touches[0];
                    offsetY = touch.clientY - element.offsetTop;
                });
                document.addEventListener("touchmove", function (e) {
                    if (isDragging) {
                        const touch = e.touches[0];
                        element.style.position = "absolute";
                        element.style.top = touch.clientY - offsetY + "px";
                    }
                });
                document.addEventListener("touchend", function () {
                    isDragging = false;
                });
            }
            function openPopup() {
                document.getElementById("popup").style.display = "block";
                document.getElementById("overlay").style.display = "block";
            }
            function closePopup() {
                document.getElementById("popup").style.display = "none";
                document.getElementById("overlay").style.display = "none";
            }
            async function generateContent() {
                const topic = document.getElementById("topicInput").value;
                if (!topic) return alert("Please enter a topic");
                const prompt = `Generate content about ${topic}`;
                const apiUrl = `https://text.pollinations.ai/ 
Format the response with:
    - no unnecessary lines left or spaces but try making new lines like shorter sentence 
    - Bullet points
    - no special charecters
    - Short paragraphs
    - Organized, concise and small ${encodeURIComponent(prompt)}`;
                try {
                    const response = await fetch(apiUrl);
                    const data = await response.text();
                    const contentBox = document.createElement("div");
                    contentBox.className = "box";
                    contentBox.innerHTML = `<div class="body-text">${data}</div>`;
                    document.getElementById("content").appendChild(contentBox);
                    attachMoveAndResizeListeners(contentBox);
                    closePopup();
                } catch (error) {
                    console.error("Error generating content:", error);
                    alert("Failed to generate content");
                }
            }
        </script>
    </body>
</html>
